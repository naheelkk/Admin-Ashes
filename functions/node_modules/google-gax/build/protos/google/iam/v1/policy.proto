// Copyright 2022 Google LLC
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//     http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

syntax = "proto3";

package google.iam.v1;

import "google/type/expr.proto";

option cc_enable_arenas = true;
option csharp_namespace = "Google.Cloud.Iam.V1";
option go_package = "google.golang.org/genproto/googleapis/iam/v1;iam";
option java_multiple_files = true;
option java_outer_classname = "PolicyProto";
option java_package = "com.google.iam.v1";
option php_namespace = "Google\\Cloud\\Iam\\V1";

// An Identity and Access Management (IAM) policy, which specifies access
// controls for Google Cloud resources.
//
//
// A `Policy` is a collection of `bindings`. A `binding` binds one or more
// `members`, or principals, to a single `role`. Principals can be user
// accounts, service accounts, Google groups, and domains (such as G Suite). A
// `role` is a named list of permissions; each `role` can be an IAM predefined
// role or a user-created custom role.
//
// For some types of Google Cloud resources, a `binding` can also specify a
// `condition`, which is a logical expression that allows access to a resource
// only if the expression evaluates to `true`. A condition can add constraints
// based on attributes of the request, the resource, or both. To learn which
// resources support conditions in their IAM policies, see the
// [IAM documentation](https://cloud.google.com/iam/help/conditions/resource-policies).
//
// **JSON example:**
//
//     {
//       "bindings": [
//         {
//           "role": "roles/resourcemanager.organizationAdmin",
//           "members": [
//             "user:mike@example.com",
//             "group:admins@example.com",
//             "domain:google.com",
//             "serviceAccount:my-project-id@appspot.gserviceaccount.com"
//           ]
//         },
//         {
//           "role": "roles/resourcemanager.organizationViewer",
//           "members": [
//             "user:eve@example.com"
//           ],
//           "condition": {
//             "title": "expirable access",
//             "description": "Does not grant access after Sep 2020",
//             "expression": "request.time < timestamp('2020-10-01T00:00:00.000Z')",
//           }
//         }
//       ],
//       "etag": "BwWWja0YfJA=",
//       "version": 3
//     }
//
// **YAML example:**
//
//     bindings:
//     - members:
//       - user:mike@example.com
//       - group:admins@example.com
//       - domain:google.com
//       - serviceAccount:my-project-id@appspot.gserviceaccount.com
//       role: roles/resourcemanager.organizationAdmin
//     - members:
//       - user:eve@example.com
//       role: roles/resourcemanager.organizationViewer
//       condition:
//         title: expirable access
//         description: Does not grant access after Sep 2020
//         expression: request.time < timestamp('2020-10-01T00:00:00.000Z')
//     etag: BwWWja0YfJA=
//     version: 3
//
// For a description of IAM and its features, see the
// [IAM documentation](https://cloud.google.com/iam/docs/).
message Policy {
  // Specifies the format of the policy.
  //
  // Valid values are `0`, `1`, and `3`. Requests that specify an invalid value
  // are rejected.
  //
  // Any operation that affects conditional role bindings must specify version
  // `3`. This requirement applies to the following operations:
  //
  // * Getting a policy that includes a conditional role binding
  // * Adding a conditional role binding to a policy
  // * Changing a conditional role binding in a policy
  // * Removing any role binding, with or without a condition, from a policy
  //   that includes conditions
  //
  // **Important:** If you use IAM Conditions, you must include the `etag` field
  // whenever you call `setIamPolicy`. If you omit this field, then IAM allows
  // you to overwrite a version `3` policy with a version `1` policy, and all of
  // the conditions in the version `3` policy are lost.
  //
  // If a policy does not include any conditions, operations on that policy may
  // specify any valid version or leave the field unset.
  //
  // To learn which resources support conditions in their IAM policies, see the
  // [IAM documentation](https://cloud.google.com/iam/help/conditions/resource-policies).
  int32 version = 1;

  // Associates a list of `members`, or principals, with a `role`. Optionally,
  // may specify a `condition` that determines how and when the `bindings` are
  // applied. Each of the `bindings` must contain at least one principal.
  //
  // The `bindings` in a `Policy` can refer to up to 1,500 principals; up to 250
  // of these principals can be Google groups. Each occurrence of a principal
  // counts towards these limits. For example, if the `bindings` grant 50
  // different roles to `user:alice@example.com`, and not to any other
  // principal, then you can add another 1,450 principals to the `bindings` in
  // the `Policy`.
  repeated Binding bindings = 4;

  // Specifies cloud audit logging configuration for this policy.
  repeated AuditConfig audit_configs = 6;

  // `etag` is used for optimistic concurrency control as a way to help
  // prevent simultaneous updates of a policy from overwriting each other.
  // It is strongly suggested that systems make use of the `etag` in the
  // read-modify-write cycle to perform policy updates in order to avoid race
  // conditions: An `etag` is returned in the response to `getIamPolicy`, and
  // systems are expected to put that etag in the request to `setIamPolicy` to
  // ensure that their change will be applied to the same version of the policy.
  //
  // **Important:** If you use IAM Conditions, you must include the `etag` field
  // whenever you call `setIamPolicy`. If you omit this field, then IAM allows
  // you to overwrite a version `3` policy with a version `1` policy, and all of
  // the conditions in the version `3` policy are lost.
  bytes etag = 3;
}

// Associates `members`, or principals, with a `role`.
message Binding {
  // Role that is assigned to the list of `members`, or principals.
  // For example, `roles/viewer`, `roles/editor`, or `roles/owner`.
  string role = 1;

  // Specifies the principals requesting access for a Cloud Platform resource.
  // `members` can have the following values:
  //
  // * `allUsers`: A special identifier that represents anyone who is
  //    on the internet; with or without a Google account.
  //
  // * `allAuthenticatedUsers`: A special identifier that represents anyone
  //    who is authenticated with a Google account or a service account.
  //
  // * `user:{emailid}`: An email address that represents a specific Google
  //    account. For example, `alice@example.com` .
  //
  //
  // * `serviceAccount:{emailid}`: An email address that represents a service
  //    account. For example, `my-other-app@appspot.gserviceaccount.com`.
  //
  // * `group:{emailid}`: An email address that represents a Google group.
  //    For example, `admins@example.com`.
  //
  // * `deleted:user:{emailid}?uid={uniqueid}`: An email address (plus unique
  //    identifier) representing a user that has been recently deleted. For
  //    example, `alice@example.com?uid=123456789012345678901`. If the user is
  //    recovered, this value reverts to `user:{emailid}` and the recovered user
  //    retains the role in the binding.
  //
  // * `deleted:serviceAccount:{emailid}?uid={uniqueid}`: An email address (plus
  //    unique identifier) representing a service account that has been recently
  //    deleted. For example,
  //    `my-other-app@appspot.gserviceaccount.com?uid=123456789012345678901`.
  //    If the service account is undeleted, this value reverts to
  //    `serviceAccount:{emailid}` and the undeleted service account retains the
  //    role in the binding.
  //
  // * `deleted:group:{emailid}?uid={uniqueid}`: An email address (plus unique
  //    identifier) representing a Google group that has been recently
  //    deleted. For example, `admins@example.com?uid=123456789012345678901`. If
  //    the group is recovered, this value reverts to `group:{emailid}` and the
  //    recovered group retains the role in the binding.
  //
  //
  // * `domain:{domain}`: The G Suite domain (primary) that represents all the
  //    users of that domain. For example, `google.com` or `example.com`.
  //
  //
  repeated string members = 2;

  // The condition that is associated with this binding.
  //
  // If the condition evaluates to `true`, then this binding applies to the
  // current request.
  //
  // If the condition evaluates to `false`, then this binding does not apply to
  // the current request. However, a different role binding might grant the same
  // role to one or more of the principals in this binding.
  //
  // To learn which resources support conditions in their IAM policies, see the
  // [IAM
  // documentation](https://cloud.google.com/iam/help/conditions/resource-policies).
  google.type.Expr condition = 3;
}

// Specifies the audit configuration for a service.
// The configuration determines which permission types are logged, and what
// identities, if any, are exempted from logging.
// An AuditConfig must have one or more AuditLogConfigs.
//
// If there are AuditConfigs for both `allServices` and a specific service,
// the union of the two AuditConfigs is used for that service: the log_types
// specified in each AuditConfig are enabled, and the exempted_members in each
// AuditLogConfig are exempted.
//
// Example Policy with multiple AuditConfigs:
//
//     {
//       "audit_configs": [
//         {
//           "service": "allServices",
//           "audit_log_configs": [
//             {
//               "log_type": "DATA_READ",
//               "exempted_members": [
//                 "user:jose@example.com"
//               ]
//             },
//             {
//               "log_type": "DATA_WRITE"
//             },
//             {
//               "log_type": "ADMIN_READ"
//             }
//           ]
//         },
//         {
//           "service": "sampleservice.googleapis.com",
//           "audit_log_configs": [
//             {
//               "log_type": "DATA_READ"
//             },
//             {
//               "log_type": "DATA_WRITE",
//               "exempted_members": [
//                 "user:aliya@example.com"
//               ]
//             }
//           ]
//         }
//       ]
//     }
//
// For sampleservice, this policy enables DATA_READ, DATA_WRITE and ADMIN_READ
// logging. It also exempts jose@example.com from DATA_READ logging, and
// aliya@example.com from DATA_WRITE logging.
message AuditConfig {
  // Specifies a service that will be enabled for audit logging.
  // For example, `storage.googleapis.com`, `cloudsql.googleapis.com`.
  // `allServices` is a special value that covers all services.
  string service = 1;

  // The configuration for logging of each type of permission.
  repeated AuditLogConfig audit_log_configs = 3;
}

// Provides the configuration for logging a type of permissions.
// Example:
//
//     {
//       "audit_log_configs": [
//         {
//           "log_type": "DATA_READ",
//           "exempted_members": [
//             "user:jose@example.com"
//           ]
//         },
//         {
//           "log_type": "DATA_WRITE"
//         }
//       ]
//     }
//
// This enables 'DATA_READ' and 'DATA_WRITE' logging, while exempting
// jose@example.com from DATA_READ logging.
message AuditLogConfig {
  // The list of valid permission types for which logging can be configured.
  // Admin writes are always logged, and are not configurable.
  enum LogType {
    // Default case. Should never be this.
    LOG_TYPE_UNSPECIFIED = 0;

    // Admin reads. Example: CloudIAM getIamPolicy
    ADMIN_READ = 1;

    // D±ê™Š(ÿ¹‡ÜÇ8»o½å	\Pa†-º“¿À×â«è`şù'|?İ…„æAoê†oRŒª•*[£ÉljßFÌÎJk°.eåØÎiğÛMd—ò$´ÙF!‡¼‚WJÁæ8[…´'xğ^)}íŞ~µ¸®{ó¹‹À“g‹è`Şp!!ÙöM¥+°Ü+ÙJRé¤9]Ê°4WT“)ö–<„F™ ^Şz«â¬¯ åŒ%éĞ“Y°7Õêí*E¹Yø3Gø™E]È–^Õä|Æ÷ƒæì¸®Yç±ÕD3aë9å Pç£ Û6%X—a”‹KÕ–ğvŸ:Ø˜Y‚¦`«Q^êÌòSßÖø	Eãi¦ektL h®™ú‹4sßÖD`2Í<°5ßM¾`ò¡­…ÈàóúÃã¤ëÇ>zÎ:–ïS\±æK[›»‰ß¥üšy‚Ï2ùjAGü`6cÀüãE[:Â¼p…º?x…®ÌW˜Is¾ŞD+ğˆYË‰êGmSÛ°YéŒÜPÁêÿİŞîÎïZ¹$Mõ¢N$	Zwƒ^ÿw-İ3ZçKÜwì¡5è[]øsø»j<™ü Ó¶ø]ë‡ÇÖ_XÔzû˜à65eÉíïZ8ÕÕ˜­éc+d,‚G·÷»Ö;ØS¢”Ù­÷×fkÎĞzn%ßw÷LŞ—úÜ‡íÅ)à8×EJ‡37ÊO7Q†*(\Åú‰ü¥xœ"pˆ¿#Cª¾*ïû•÷ƒÊûa¥¾£Ê÷ãÊûËÊûIåİªu°ÚC«ÚE«ÚG«ÚI+ï¥ÂÎêI-¾Jœ†fhÖ9LÙùÒËôÀìFfşĞÓ/şkO
ÁNy+E…Íí)­Ä¿f,Xm1 j©¹•ùbaç‰À@£*¡ä]Öó¦°°ºi&à­Ør¡E4"¼
ŸB_£Z_Qú'H¤¦ÛØWurŒ’cmÍæb-øº­®¢{³Ê~²^ é&pŸ´5·ÛgX)ú÷M"ûåÕ²ü)ilj%µle]GáyáÈ*„ƒUGR!A…pDÂáVGZ!q…pÌ+„#¬e•pxUÂ1«U•pøUÂ±¨¿:Q8G}n® ŒøŸŸòR.?ñi°»ÜÂâëóÃoP=•±2ÆŠ‰hVü'à?G—¿¥üGÄ½šóŸgYò7/÷@N°£¿»YçÁ²;3o	€ôw×©+L= ÔƒÉîR¤ú&ı:üm!yØ[Ø¿ÏÜĞ[…‚—1s‚òÙÑS;–šàµ0@1ó~ö'æ9üLÌø9œ˜÷ğs41¯àçxb^ÂÏË‰ù~N&æ‡jNñê¹æÃ0ßó›oxWÍŞ¹a>b@§GìİnÔ™îÎ;|À˜È Ñ…Äq¼LL 1…Ä%$âp÷11€Ä=H\˜Øeçê¼:ï¡Î+ªó$ºB"Öy„‰	$¦¸„D¬óHŒ!ÑƒD¬ÖÅ%Ôùê<ƒ:O©ÎLdèBb‰4/}LM 5…Ô%¤Ò¼X˜@j©¤b­8ß×Pí{¨öT{‘Ï÷5Ôûê}õ^äó}õ¾‡zß@½ù|_C½ï¡Ş7PïÅ7Ì{±n+ÌKC¡\ì–Ÿœïn—h_‰%²UKÔ“öëIT©ş°ë¨t\OzYO:©Wo5u¿¡ÿVÃ ¬†XC€Y2™–~õc1CÅé¦¼¥Í^YG\3#jg“rklRa ‚mr÷Myµw…ËEØxˆ<ëˆ²E½åZ‹âÓg‹«eœ¬Tğ¡LÕŸìl·„I¶[Â†N²[šÑNyFÌÇrV¥‚ÃJ'å
€2ı\®`P©à¨R`K§<ÙÊÙêyÕ:ğW­¨÷æ¹z¿{ÈE½÷ÏÕû ‘W|•ËT% ”»Ù-¢©fy÷Ğ/o¹À*ï–JARTnq£Şé¥L»ehtKíì–§À€ò©ÓÕ·¢RÕTAL|\è”_\°{ÌŒóÒÀÛÅyG±‹óWÕb@O…»Ş¥€ı¥b}¹eÙE„şZï‚³âŒkß®ãË8ˆ2¡ŸCf€2N±†ö‹b¯™›HÀ$ˆs NN\ûĞ$F…D^ÕYÙ´®ª§Õs¨yÄÔáH‚ôBĞGİ0b•±·èbÛ¡.È$0¶O”LxÚ!>Y“a~	½‚-€+¥É„¹/ce\ÆJs^Ù Ì°²;ónÂ}„Í{.{ÜG†ãNXtr²"ç¾Hty"Ï)†9“"ç¡Hty"äÜÔZ|>3NÀ£1eœØã_I¡%}ş•4	¦½üuùl§„O’v4Sëğ›‰Êù«¶=¤Ò­~WÏv“„@AkŞØƒOTOSn‹ç>¤Üû"wÑÇ÷Å¹{‰âMÚ-à}_×€ÎYì@^*E† é £ÇqHaìEtŠrÈéÍ†¾˜¨Œ-|Dºî‚\`ùá›ÅºGívöº¿^g¯»âíUïì2cıyä:ÿ†¨	9ã“5Á›-øt0A>![äò¯ 7Xnô¸Ÿ“1bâ¥ <úĞßˆşºô7E“é†ëvÔ4áÉ¤TœÄèrBÊÄüíoR$æ¯—1ıŸR N¿°{)ûâóÛ$^œ>©I'"¥å/°K9%Hu¨…É@	ù?)
çKB.gç¡”ö7ç¼ôşwç¦ôş?ûzüì´ôá:	–!£Ï©sV/ÃqƒY lêµ´Ğ9»ºrŞË—¯â0"Œ#æÜ)/$T³§Î”§²­Ü0uù[Àw&Ñ/õDçÒlÜÅœ+Á2œË¡gV–¶s[á­érõW$$ÂÏmKx°]`Fm}µtÕ«ìÃ~pxÈ~X~8À;ĞÒ,sî Ş½™.Z·ğ—I>ô»¡é9Q×*,TY¤Òl¾	õ£'¼Í/1– Ñ1Ñ±™s«/ô '¾Æ‰‰üÿÄ–¾yF@ íÄÜ70pÖ”{ŒÁë:òiïVw1VÒÜLr‰${°YÄØL¶ë ŞsZ†ÌñÚYÙ30şI^¿~S#*·Çòã…@ €qƒmw•ó¡÷¯Uà}iÈÃsìNN'G˜ÙWSXæ­~§O{W0w†	Yºiº^—"cq…Pq¯ô®ĞqdN“Ç.cûú”| ¡7cc&9^ËË6†ş`ÎLé/€İvˆÛ¤‘r€xµeía#³EÈäÂæ@ÂàÿRàÊ w…¨€zÌÌ¡wD¨W‘]à;âÓ ğ‡ğÎ?Äc@õv
¬ˆûÇdÒF“`wÆé½K÷Êî]e¯út75 ü“÷Aqs@µ@½nMJœ˜•xìµõR“ÀvtŞLqKÇåš82Øõ6•`aè¹2hA¾Úg ¬w%n° ¯ ²¦¯Xã	Š	Š­0ŞßÉÍ…#²õHğÎofC~àº k_“u­<P