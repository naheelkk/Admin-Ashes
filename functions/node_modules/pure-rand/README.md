<h1>
  <img src="https://raw.githubusercontent.com/dubzzz/pure-rand/main/assets/logo.svg" alt="pure-rand logo" />
</h1>

Fast Pseudorandom number generators (aka PRNG) with purity in mind!

[![Build Status](https://github.com/dubzzz/pure-rand/workflows/Build%20Status/badge.svg?branch=main)](https://github.com/dubzzz/pure-rand/actions)
[![NPM Version](https://badge.fury.io/js/pure-rand.svg)](https://badge.fury.io/js/pure-rand)
[![Monthly Downloads](https://img.shields.io/npm/dm/pure-rand)](https://www.npmjs.com/package/pure-rand)

[![Codecov](https://codecov.io/gh/dubzzz/pure-rand/branch/main/graph/badge.svg)](https://codecov.io/gh/dubzzz/pure-rand)
[![Package Quality](https://packagequality.com/shield/pure-rand.svg)](https://packagequality.com/#?package=pure-rand)
[![Snyk Package Quality](https://snyk.io/advisor/npm-package/pure-rand/badge.svg)](https://snyk.io/advisor/npm-package/pure-rand)

[![PRs Welcome](https://img.shields.io/badge/PRs-welcome-brightgreen.svg)](https://github.com/dubzzz/pure-rand/labels/good%20first%20issue)
[![License](https://img.shields.io/npm/l/pure-rand.svg)](https://github.com/dubzzz/pure-rand/blob/main/LICENSE)
[![Twitter](https://img.shields.io/twitter/url/https/github.com/dubzzz/pure-rand.svg?style=social)](https://twitter.com/intent/tweet?text=Check%20out%20pure-rand%20by%20%40ndubien%20https%3A%2F%2Fgithub.com%2Fdubzzz%2Fpure-rand%20%F0%9F%91%8D)

## Getting started

**Install it in node via:**

`npm install pure-rand` or `yarn add pure-rand`

**Use it in browser by doing:**

`import * as prand from 'https://unpkg.com/pure-rand/lib/esm/pure-rand.js';`

## Usage

**Simple usage**

```javascript
import prand from 'pure-rand';

const seed = 42;
const rng = prand.xoroshiro128plus(seed);
const firstDiceValue = prand.unsafeUniformIntDistribution(1, 6, rng); // value in {1..6}, here: 2
const secondDiceValue = prand.unsafeUniformIntDistribution(1, 6, rng); // value in {1..6}, here: 4
const thirdDiceValue = prand.unsafeUniformIntDistribution(1, 6, rng); // value in {1..6}, here: 6
```

**Pure usage**

Pure means that the instance `rng` will never be altered in-place. It can be called again and again and it will always return the same value. But it will also return the next `rng`. Here is an example showing how the code above can be translated into its pure version:

```javascript
import prand from 'pure-rand';

const seed = 42;
const rng1 = prand.xoroshiro128plus(seed);
const [firstDiceValue, rng2] = prand.uniformIntDistribution(1, 6, rng1); // value in {1..6}, here: 2
const [secondDiceValue, rng3] = prand.uniformIntDistribution(1, 6, rng2); // value in {1..6}, here: 4
const [thirdDiceValue, rng4] = prand.uniformIntDistribution(1, 6, rng3); // value in {1..6}, here: 6

// You can call: prand.uniformIntDistribution(1, 6, rng1);
// over and over it will always give you back the same value along with a new rng (always producing the same values too).
```

**Independent simulations**

In order to produce independent simulations it can be tempting to instanciate several PRNG based on totally different seeds. While it would produce distinct set of values, the best way to ensure fully unrelated sequences is rather to use jumps. Jump just consists into moving far away from the current position in the generator (eg.: jumping in Xoroshiro 128+ will move you 2<sup>64</sup> generations away from the current one on a generator having a sequence of 2<sup>128</sup> elements).

```javascript
import prand from 'pure-rand';

const seed = 42;
const rngSimulation1 = prand.xoroshiro128plus(seed);
const rngSimulation2 = rngSimulation1.jump(); // not in-place, creates a new instance
const rngSimulation3 = rngSimulation2.jump(); // not in-place, creates a new instance

const diceSim1Value = prand.unsafeUniformIntDistribution(1, 6, rngSimulation1); // value in {1..6}, here: 2
const diceSim2Value = prand.unsafeUniformIntDistribution(1, 6, rngSimulation2); // value in {1..6}, here: 5
const diceSim3Value = prand.unsafeUniformIntDistribution(1, 6, rngSimulation3); // value in {1..6}, here: 6
```

**Non-uniform usage**

While not recommended as non-uniform distribution implies that one or several values from the range will be more likely than others, it might be tempting for people wanting to maximize the throughput.

```javascript
import prand from 'pure-rand';

const seed = 42;
const rng = prand.xoroshiro128plus(seed);
const rand = (min, max) => {
  const out = (rng.unsafeNext() >>> 0) / 0x100000000;
  return min + Math.floor(out * (max - min + 1));
};
const firstDiceValue = rand(1, 6); // value in {1..6}, here: 6
```

**Select your seed**

While not perfect, here is a rather simple way to generate a seed for your PNRG.

```javascript
const seed = Date.now() ^ (Math.random() * 0x100000000);
```

## Documentation

### Pseudorandom number generators

In computer science most random number generators<sup>(1)</sup> are [pseudorandom number generators](https://en.wikipedia.org/wiki/Pseudorandom_number_generator) (abbreviated: PRNG). In other words, they are fully deterministic and given the original seed one can rebuild the whole sequence.

Each PRNG algorithm has to deal with tradeoffs in terms of randomness quality, speed, length of the sequence<sup>(2)</sup>... In other words, it's important to compare relative speed of libraries with that in mind. Indeed, a Mersenne Twister PRNG will not have the same strenghts and weaknesses as a Xoroshiro PRNG, so depending on what you need exactly you might prefer one PRNG over another even if it will be slower.

4 PRNGs come with pure-rand:

- `congruential32`: Linear Congruential generator — \[[more](https://en.wikipedia.org/wiki/Linear_congruential_generator)\]
- `mersenne`: Mersenne Twister generator — \[[more](https://en.wikipedia.org/wiki/Mersenne_Twister)\]
- `xorshift128plus`: Xorshift 128+ generator — \[[more](https://en.wikipedia.org/wiki/Xorshift)\]
- `xoroshiro128plus`: Xoroshiro 128+ generator — \[[more](https://en.wikipedia.org/wiki/Xorshift)\]

Our recommendation is `xoroshiro128plus`. But if you want to use another one, you can replace it by any other PRNG provided by pure-rand in the examples above.

### Distributions

Once you are able to generate random values, next step is to scale them into the range you want. Indeed, you probably don't want a floating point value between 0 (included) and 1 (excluded) but rather an integer value between 1 and 6 if you emulate a dice or any other range based on your needs.

At this point, simple way would be to do `min + floor(random() * (max - min + 1))` but actually it will not generate the values with equal probabilities even if you use the best PRNG in the world to back `random()`. In order to have equal probabilities you need to rely on uniform distributions<sup>(3)</sup> which comes built-in in some PNRG libraries.

pure-rand provides 3 built-in functions for uniform distributions of values:

- `uniformIntDistribution(min, max, rng)`
- `uniformBigIntDistribution(min, max, rng)` - with `min` and `max` being `bigint`
- `uniformArrayIntDistribution(min, max, rng)` - with `min` and `max` being instances of `ArrayInt = {sign, data}` ie. sign either 1 or -1 and data an array of numbers between 0 (included) and 0xffffffff (included)

And their unsafe equivalents to change the PRNG in-place.

### Extra helpers

Some helpers are also provided in order to ease the use of `RandomGenerator` instances:

- `prand.generateN(rng: RandomGenerator, num: number): [number[], RandomGenerator]`: generates `num` random values using `rng` and return the next `RandomGenerator`
- `prand.skipN(rng: RandomGenerator, num: number): RandomGenerator`: skips `num` random values and return the next `RandomGenerator`

## Comparison

### Summary

The chart has been split into three sections:

- section 1: native `Math.random()`
- section 2: without uniform distribution of values
- section 3: with uniform distribution of values (not supported by all libraries)

<img src="https://raw.githubusercontent.com/dubzzz/pure-rand/main/perf/comparison.svg" alt="Comparison against other libraries" />

### Process

In order to compare the performance of the libraries, we aked them to shuSrsbGkGpMVX9xhTvRgm","source":"msn"},{"id":"BB1ktd0U","type":"article","title":"Massive Fire Breaks Out in Ujjain Mahakal Temple Amid Holi Celebrations, 13 Injured","abstract":"At least 13 people, mostly priests were injured in a massive fire that broke out in the Madhya Pradesh’s Ujjain Mahakal Temple on Monday. The fire occurred during the early morning’s ‘bhasma aarti’, amid Holi celebration on the premises, an official said.The blaze took place in the ‘garba griha’ (sanctum sanctorum) of the temple, Ujjain Collector Neeraj Kumar Singh said.“Thirteen priests suffered burn injuries and are being treated in the...","readTimeMin":1,"url":"https://www.msn.com/en-in/news/India/massive-fire-breaks-out-in-ujjain-mahakal-temple-amid-holi-celebrations-13-injured/ar-BB1ktd0U","locale":"en-in","isLocalContent":true,"galleryItemCount":0,"publishedDateTime":"2024-03-25T04:10:34Z","isFeatured":false,"images":[{"width":1200,"height":800,"url":"https://th.bing.com/th?id=ORMS.4f745a74eb20ca390c7e240f91de4af6&pid=Wdp","title":"The deceased were identified as 9-year-old Rinki Kumari, and her two brothers -- Raja Kumar, 12, and Subhankar Kumar, 13.(Image: Representative/ANI)","caption":"The deceased were identified as 9-year-old Rinki Kumari, and her two brothers -- Raja Kumar, 12, and Subhankar Kumar, 13.(Image: Representative/ANI)","source":"msn","colorSamples":[{"isDarkMode":true,"hexColor":"#5b2e2e","isGreyScale":false},{"isDarkMode":false,"hexColor":"#F5F5F5","isGreyScale":false}]}],"colorSamples":[{"isDarkMode":true,"hexColor":"#5b2e2e","secHexColor":"#523145","gradientAngle":"135deg","isGreyScale":false},{"isDarkMode":false,"hexColor":"#F5F5F5","secHexColor":"#C2C2C2","gradientAngle":"135deg","isGreyScale":false}],"provider":{"id":"AAJUFxM","name":"News18","logoUrl":"https://img-s-msn-com.akamaized.net/tenant/amp/entityid/BBWDbS5.img","profileId":"vid-aaxr67xg65m37km858ut5c4yh6cky9hayums237em8yruef2cfxs","lightThemeSVGLogo":{"width":50,"height":12,"url":"https://cdn.query.prod.cms.msn.com/cms/api/amp/binary/AA13gAZz"},"darkThemeSVGLogo":{"width":50,"height":12,"url":"https://cdn.query.prod.cms.msn.com/cms/api/amp/binary/AA13gAZz-dark"}},"category":"news","reactionSummary":{"totalCount":86,"subReactionSummaries":[{"totalCount":63,"type":"upvote"},{"totalCount":23,"type":"downvote"}]},"reactionStatus":"on","commentSummary":{"totalCount":12,"subCommentSummaries":[{"totalCount":11,"type":"comment"},{"totalCount":1,"type":"reply"}]},"commentStatus":"on","recoDocMetadata":null,"feed":{"id":"Y_e3456e91-215f-4a5c-ab78-6874509075ef","feedName":"India","lastFreActionTimestamp":0},"cardId":49,"isWorkNewsContent":false,"recoId":"cejuShASrsbGkGpMVX9xhTvRgm","source":"msn"}],"feed":{"id":"Y_0b495ad3-9beb-45f8-9214-c8e95aa2468f","feedName":"Top stories","canonicalName":"topstories","lastFreActionTimestamp":0},"cardId":38,"isTriggeredByClient":false},{"id":"BB1jstqN","type":"article","title":"Did you wake up tired? There's more to blame than lack of sleep","abstract":"If you are waking up each morning after your stipulated eight hours of sleep and still feeling fatigued, you need to get yourself checked for hidden problems.","readTimeMin":5,"url":"https://www.msn.com/en-in/health/health-news/did-you-wake-up-tired-there-s-more-to-blame-than-lack-of-sleep/ar-BB1jstqN","locale":"en-in","isLocalContent":false,"galleryItemCount":0,"publishedDateTime":"2024-03-07T02:30:00Z","isFeatured":false,"images":[{"width":1200,"height":675,"url":"https://th.bing.com/th?id=ORMS.4dcc39f7c4de99d7d8a5c3d562b741e3&pid=Wdp","title":"Did you wake u