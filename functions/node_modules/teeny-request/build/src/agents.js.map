].parseApiCallResultAsync(${i}) failed, emptyResponse=${e}`+n,privateMessage:r},f))}else return Promise.reject(new t(u,{publicMessage:`[MsbHttpWrapper].parseApiCallResultAsync(${i}) failed non-HTTP200`,privateMessage:r}))}validateTokenExpiry(i){const r=i.tokenJwtExp;if(r){const u=n.getCurrentTime(),f=r-u;if(f<0){const e=i.tokenRefreshTime,o=u-(e||0);throw new t({statusCode:n.ClientErrorCode.MsbTokenExpiredBeforeRequest},{publicMessage:`{[MsbHttpWrapper].sendHttpAsync}, rt=${e}, jwtExp=${r}, now=${u}`});}}}checkServerTime(t,r,u){if(n.config.msbServerClientTimeSkewLimitMins&&t.checkServerTime){const{serverTime:f,requestSentTime:e,serverTraceId:o}=r;if(f&&e){const r=f-e,s=`[MsbHttpWrapper].${u} returned, ServerTime=${f}, ClientTime=${e}, diff=${r}, urlBase=${n.msbHost.urlUtils.getUrlBaseInfo(t.url)}`,h=`Target URL: ${t.url}`;if(Math.abs(r)>n.config.msbServerClientTimeSkewLimitMins*i){const t=n.msbHost.isMsbInternalTenant()?h:undefined;bfbWsbTel.logError("Wsb server and client time mismatch",s,{serverTraceId:o,additionalMessage:t})}}}}getServerInfoFromHeader(t){const i=t===null||t===void 0?void 0:t[r],f=t===null||t===void 0?void 0:t[u];if(i||f)return{serverTraceId:i,serverLatency:f};const e=n.getMsEdgeRef(t),{traceId:o,timestamp:s}=e||{};return{serverTraceId:o,serverTime:s}}}n.MsbHttpWrapper=f}(WSB||(WSB={})),function(n){const t="X-Client-Language",i="X-Client-LocalTime",r="Client-Request-Id",u="User-Agent",f="6ba82e35-cb33-52a3-710a-75b1290faba1.1000.01",e="https://substrate.office.com/search/api/v1/events?scenario=",o="SearchEntityActions";class s{logSearchEntityActions(s,h){var a,v,y,p,w,b;if(!n.msbHost.features.isWsbLoggerForDmaRegionDisabled()){const k=e+s,c=n.msbHost.getAadUserInfo(),g=[{Key:(a=window===null||window===void 0?void 0:window._G)===null||a===void 0?void 0:a.IG,Value:[{Name:o,Attributes:[{Key:"Id",Value:f},{Key:"LocalTime",Value:n.getDateWithTimezone()},{Key:"EventType",Value:"EntityClicked"},{Key:"UserId",Value:(v=c===null||c===void 0?void 0:c.userAadId)!==null&&v!==void 0?v:""},{Key:"TenantId",Value:(y=c===null||c===void 0?void 0:c.tenantId)!==null&&y!==void 0