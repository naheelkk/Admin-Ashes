/*!
 * send
 * Copyright(c) 2012 TJ Holowaychuk
 * Copyright(c) 2014-2022 Douglas Christopher Wilson
 * MIT Licensed
 */

'use strict'

/**
 * Module dependencies.
 * @private
 */

var createError = require('http-errors')
var debug = require('debug')('send')
var deprecate = require('depd')('send')
var destroy = require('destroy')
var encodeUrl = require('encodeurl')
var escapeHtml = require('escape-html')
var etag = require('etag')
var fresh = require('fresh')
var fs = require('fs')
var mime = require('mime')
var ms = require('ms')
var onFinished = require('on-finished')
var parseRange = require('range-parser')
var path = require('path')
var statuses = require('statuses')
var Stream = require('stream')
var util = require('util')

/**
 * Path function references.
 * @private
 */

var extname = path.extname
var join = path.join
var normalize = path.normalize
var resolve = path.resolve
var sep = path.sep

/**
 * Regular expression for identifying a bytes Range header.
 * @private
 */

var BYTES_RANGE_REGEXP = /^ *bytes=/

/**
 * Maximum value allowed for the max age.
 * @private
 */

var MAX_MAXAGE = 60 * 60 * 24 * 365 * 1000 // 1 year

/**
 * Regular expression to match a path with a directory up component.
 * @private
 */

var UP_PATH_REGEXP = /(?:^|[\\/])\.\.(?:[\\/]|$)/

/**
 * Module exports.
 * @public
 */

module.exports = send
module.exports.mime = mime

/**
 * Return a `SendStream` for `req` and `path`.
 *
 * @param {object} req
 * @param {string} path
 * @param {object} [options]
 * @return {SendStream}
 * @public
 */

function send (req, path, options) {
  return new SendStream(req, path, options)
}

/**
 * Initialize a `SendStream` with the given `path`.
 *
 * @param {Request} req
 * @param {String} path
 * @param {object} [options]
 * @private
 */

function SendStream (req, path, options) {
  Stream.call(this)

  var opts = options || {}

  this.options = opts
  this.path = path
  this.req = req

  this._acceptRanges = opts.acceptRanges !== undefined
    ? Boolean(opts.acceptRanges)
    : true

  this._cacheControl = opts.cacheControl !== undefined
    ? Boolean(opts.cacheControl)
    : true

  this._etag = opts.etag !== undefined
    ? Boolean(opts.etag)
    : true

  this._dotfiles = opts.dotfiles !== undefined
    ? opts.dotfiles
    : 'ignore'

  if (this._dotfiles !== 'ignore' && this._dotfiles !== 'allow' && this._dotfiles !== 'deny') {
    throw new TypeError('dotfiles option must be "allow", "deny", or "ignore"')
  }

  this._hidden = Boolean(opts.hidden)

  if (opts.hidden !== undefined) {
    deprecate('hidden: use dotfiles: \'' + (this._hidden ? 'allow' : 'ignore') + '\' instead')
  }

  // legacy support
  if (opts.dotfiles === undefined) {
    this._dotfiles = undefined
  }

  this._extensions = opts.extensions !== undefined
    ? normalizeList(opts.extensions, 'extensions option')
    : []

  this._immutable = opts.immutable !== undefined
    ? Boolean(opts.immutable)
    : false

  this._index = opts.index !== undefined
    ? normalizeList(opts.index, 'index option')
    : ['index.html']

  this._lastModified = opts.lastModified !== undefined
    ? Boolean(opts.lastModified)
    : true

  this._maxage = opts.maxAge || opts.maxage
  this._maxage = typeof this._maxage === 'string'
    ? ms(this._maxage)
    : Number(this._maxage)
  this._maxage = !isNaN(this._maxage)
    ? Math.min(Math.max(0, this._maxage), MAX_MAXAGE)
    : 0

  this._root = opts.root
    ? resolve(opts.root)
    : null

  if (!this._root && opts.from) {
    this.from(opts.from)
  }
}

/**
 * Inherits from `Stream`.
 */

util.inherits(SendStream, Stream)

/**
 * Enable or disable etag generation.
 *
 * @param {Boolean} val
 * @return {SendStream}
 * @api public
 */

SendStream.prototype.etag = deprecate.function(function etag (val) {
  this._etag = Boolean(val)
  debug('etag %s', this._etag)
  return this
}, 'send.etag: pass etag as option')

/**
 * Enable or disable "hidden" (dot) files.
 *
 * @param {Boolean} path
 * @return {SendStream}
 * @api public
 */

SendStream.prototype.hidden = deprecate.function(function hidden (val) {
  this._hidden = Boolean(val)
  this._dotfiles = undefined
  debug('hidden %s', this._hidden)
  return this
}, 'send.hidden: use dotfiles option')

/**
 * Set index `paths`, set to a falsy
 * value to disable index support.
 *
 * @param {String|Boolean|Array} paths
 * @return {SendStream}
 * @api public
 */

SendStream.prototype.index = deprecate.function(function index (paths) {
  var index = !paths ? [] : normalizeList(paths, 'paths argument')
  debug('index %o', paths)
  this._index = index
  return this
}, 'send.index: pass index as option')

/**
 * Set root `path`.
 *
 * @param {String} path
 * @return {SendStream}
 * @api public
 */

SendStream.prototype.root = function root (path) {
  this._root = resolve(String(path))
  debug('root %s', this._root)
  return this
}

SendStream.prototype.from = deprecate.function(SendStream.prototype.root,
  'send.from: pass root as option')

SendStream.prototype.root = deprecate.function(SendStream.prototype.root,
  'send.root: pass root as option')

/**
 * Set max-age to `maxAge`.
 *
 * @param {Number} maxAge
 * @return {SendStream}
 * @api public
 */

SendStream.prototype.maxage = deprecate.function(function maxage (maxAge) {
  this._maxage = typeof maxAge === 'string'
    ? ms(maxAge)
    : Number(maxAge)
  this._maxage = !isNaN(this._maxage)
    ? Math.min(Math.max(0, this._maxage), MAX_MAXAGE)
    : 0
  debug('max-age %d', this._maxage)
  return this
}, 'send.maxage: pass maxAge as option')

/**
 * Emit error with `status`.
 *
 * @param {number} status
 * @param {Error} [err]
 * @private
 */

SendStream.prototype.error = function error (status, err) {
  // emit if listeners instead of responding
  if (hasListeners(this, 'error')) {
    return this.emit('error', createHttpError(status, err))
  }

  var res = this.res
  var msg = statuses.message[status] || String(status)
  var doc = createHtmlDocument('Error', escapeHtml(msg))

  // clear existing headers
  clearHeaders(res)

  // add error headers
  if (err && err.headers) {
    setHeaders(res, err.headers)
  }

  // send basic response
  res.statusCode = status
  res.setHeader('Content-Type', 'text/html; charset=UTF-8')
  res.setHeader('Content-Length', Buffer.byteLength(doc))
  res.setHeader('Content-Security-Policy', "default-src 'none'")
  res.setHeader('X-Content-Type-Options', 'nosniff')
  res.end(doc)
}

/**
 * Check if the pathname ends with "/".
 *
 * @return {boolean}
 * @private
 */

SendStream.prototype.hasTrailingSlash = function hasTrailingSlash () {
  return this.path[this.path.length - 1] === '/'
}

/**
 * Check if this is a conditional GET request.
 *
 * @return {Boolean}
 * @api private
 */

SendStream.prototype.isConditionalGET = function isConditionalGET () {
  return this.req.headers['if-match'] ||
    this.req.headers['if-unmodified-since'] ||
    this.req.headers['if-none-match'] ||
    this.req.headers['if-modified-since']
}

/**
 * Check if the request preconditions failed.
 *
 * @return {boolean}
 * @private
 */

SendStream.prototype.isPreconditionFailure = function isPreconditionFailure () {
  var req = this.req
  var res = this.res

  // if-match
  var match = req.headers['if-match']
  if (match) {
    var etag = res.getHeader('ETag')
    return !etag || (match !== '*' && parseTokenList(match).every(function (match) {
      return match !== etag && match !== 'W/' + etag && 'W/' + match !== etag
    }))
  }

  // if-unmodified-since
  var unmodifiedSince = parseHttpDate(req.headers['if-unmodified-since'])
  if (!isNaN(unmodifiedSince)) {
    var lastModified = parseHttpDate(res.getHeader('Last-Modified'))
    return isNaN(lastModified) || lastModified > unmodifiedSince
  }

  return false
}

/**
 * Strip various content header fields for a change in entity.
 *
 * @private
 */

SendStream.prototype.removeContentHeaderFields = function removeContentHeaderFields () {
  var res = this.res

  res.removeHeader('Content-Encoding')
  res.removeHeader('Content-Language')
  res.removeHeader('Content-Length')
  res.removeHeader('Content-Range')
  res.removeHeader('Content-Type')
}

/**
 * Respond with 304 not modified.
 *
 * @api private
 */

SendStream.prototype.notModified = function notModified () {
  var res = this.res
  debug('not modified')
  this.removeContentHeaderFields()
  res.statusCode = 304
  res.end()
}

/**
 * Raise error that headers already sent.
 *
 * @api private
 */

SendStream.prototype.headersAlreadySent = function headersAlreadySent () {
  var err = new Error('Can\'t set headers after they are sent.')
  debug('headers already sent')
  this.error(500, err)
}

/**
 * Check if the request is cacheable, aka
 * responded with 2xx or 304 (see RFC 2616 section 14.2{5,6}).
 *
 * @return {Boolean}
 * @api private
 */

SendStream.prototype.isCachable = function isCachable () {
  var statusCode = this.res.statusCode
  return (statusCode >= 200 && statusCode < 300) ||
    statusCode === 304
}

/**
 * Handle stat() error.
 *
 * @param {Error} error
 * @private
 */

SendStream.prototype.onStatError = function onStatError (error) {
  switch (error.code) {
    case 'ENAMETOOLONG':
    case 'ENOENT':
    case 'ENOTDIR':
      this.error(404, error)
      break
    default:
      this.error(500, error)
      break
  }
}

/**
 * Check if the cache is fresh.
 *
 * @return {Boolean}
 * @api private
 */

SendStream.prototype.isFresh = function isFresh () {
  return fresh(this.req.headers, {
    etag: this.res.getHeader('ETag'),
    'last-modified': this.res.getHeader('Last-Modified')
  })
}

/**
 * Check if the range is fresh.
 *
 * @return {Boolean}
 * @api private
 */

SendStream.prototype.isRangeFresh = function isRangeFresh () {
  var ifRange = this.req.headers['if-range']

  if (!ifRange) {
    return true
  }

  // if-range as etag
  if (ifRange.indexOf('"') !== -1) {
    var etag = this.res.getHeader('ETag')
    return Boolean(etag && ifRange.indexOf(etag) !== -1)
  }

  // if-range as modified date
  var lastModified = this.res.getHeader('Last-Modified')
  return parseHttpDate(lastModified) <= parseHttpDate(ifRange)
}

/**
 * Redirect to path.
 *
 * @param {string} path
 * @private
 */

SendStream.prototype.redirect = function redirect (path) {
  var res = this.res

  if (hasListeners(this, 'directory')) {
    this.emit('directory', res, path)
    return
  }

  if (this.hasTrailingSlash()) {
    this.error(403)
    return
  }

  var loc = encodeUrl(collapseLeadingSlashes(this.path + '/'))
  var doc = createHtmlDocument('Redirecting', 'Redirecting to <a href="' + escapeHtml(loc) + '">' +
    escapeHtml(loc) + '</a>')

  // redirect
  res.statusCode = 301
  res.setHeader('Content-Type', 'text/html; charset=UTF-8')
  res.setHeader('Content-Length', Buffer.byteLength(doc))
  res.setHeader('Content-Security-Policy', "default-src 'none'")
  res.setHeader('X-Content-Type-Options', 'nosniff')
  res.setHeader('Location', loc)
  res.end(doc)
}

/**
 * Pipe to `res.
 *
 * @param {Stream} res
 * @return {Stream} res
 * @api public
 */

SendStream.prototype.pipe = function pipe (res) {
  // root path
  var root = this._root

  // references
  this.res = res

  // decode the path
  var path = decode(this.path)
  if (path === -1) {
    this.error(400)
    return res
  }

  // null byte(s)
  if (~path.indexOf('\0')) {
    this.error(400)
    return res
  }

  var parts
  if (root !== null) {
    // normalize
    if (path) {
      path = normalize('.' + sep + path)
    }

    // malicious path
    if (UP_PATH_REGEXP.test(path)) {
      debug('malicious path "%s"', path)
      this.error(403)
      return res
    }

    // explode path parts
    parts = path.split(sep)

    // join / normalize from optional root dir
    path = normalize(join(root, path))
  } else {
    // ".." is malicious without "root"
    if (UP_PATH_REGEXP.test(path)) {
      debug('malicious path "%s"', path)
      this.error(403)
      return res
    }

    // explode path parts
    parts = normalize(path).split(sep)

    // resolve the path
    path = resolve(path)
  }

  // dotfile handling
  if (containsDotFile(parts)) {
    var access = this._dotfiles

    // legacy support
    if (access === undefined) {
      access = parts[parts.length - 1][0] === '.'
        ? (this._hidden ? 'allow' : 'ignore')
        : 'allow'
    }

    debug('%s dotfile "%s"', access, path)
    switch (access) {
      case 'allow':
        break
      case 'deny':
        this.error(403)
        return res
      case 'ignore':
      default:
        this.error(404)
        return res
    }
  }

  // index file support
  if (this._index.length && this.hasTrailingSlash()) {
    this.sendIndex(path)
    return res
  }

  this.sendFile(path)
  return res
}

/**
 * Transfer `path`.
 *
 * @param {String} path
 * @api public
 */

SendStream.prototype.send = function send (path, stat) {
  var len = stat.size
  var options = this.options
  var opts = {}
  var res = this.res
  var req = this.req
  var ranges = req.headers.range
  var offset = options.start || 0

  if (headersSent(res)) {
    // impossible to send now
    this.headersAlreadySent()
    return
  }

  debug('pipe "%s"', path)

  // set header fields
  this.setHeader(path, stat)

  // set content-type
  this.type(path)

  // conditional GET support
  if (this.isConditionalGET()) {
    if (this.isPreconditionFailure()) {
      this.error(412)
      return
    }

    if (this.isCachable() && this.isFresh()) {
      this.notModified()
      return
    }
  }

  // adjust len to start/end options
  len = Math.max(0, len - offset)
  if (options.end !== undefined) {
    var bytes = options.end - offset + 1
    if (len > bytes) len = bytes
  }

  // Range support
  if (this._acceptRanges && BYTES_RANGE_REGEXP.test(ranges)) {
    // parse
    ranges = parseRange(len, ranges, {
      combine: true
    })

    // If-Range support
    if (!this.isRangeFresh()) {
      debug('range stale')
      ranges = -2
    }

    // unsatisfiable
    if (ranges === -1) {
      debug('range unsatisfiable')

      // Content-Range
      res.setHeader('Content-Range', contentRange('bytes', len))

      // 416 Requested Range Not Satisfiable
      return this.error(416, {
        headers: { 'Content-Range': res.getHeader('Content-Range') }
      })
    }

    // valid (syntactically invalid/multiple ranges are treated as a regular response)
    if (ranges !== -2 && ranges.length === 1) {
      debug('range %j', ranges)

      // Content-Range
      res.statusCode = 206
      res.setHeader('Content-Range', contentRange('bytes', len, ranges[0]))

      // adjust for requested range
      offset += ranges[0].start
      len = ranges[0].end - ranges[0].start + 1
    }
  }

  // clone options
  for (var prop in options) {
    opts[prop] = options[prop]
  }

  // set read options
  opts.start = offset
  opts.end = Math.max(offset, offset + len - 1)

  // content-length
  res.setHeader('Content-Length', len)

  // HEAD support
  if (req.method === 'HEAD') {
    res.end()
    return
  }

  this.stream(path, opts)
}

/**
 * Transfer file for `path`.
 *
 * @param {String} path
 * @api private
 */
SendStream.prototype.sendFile = function sendFile (path) {
  var i = 0
  var self = this

  debug('stat "%s"', path)
  fs.stat(path, function onstat (err, stat) {
    if (err && err.code === 'ENOENT' && !extname(path) && path[path.length - 1] !== sep) {
      // not found, check extensions
      return next(err)
    }
    if (err) return self.onStatError(err)
    if (stat.isDirectory()) return self.redirect(path)
    self.emit('file', path, stat)
    self.send(path, stat)
  })

  function next (err) {
    if (self._extensions.length <= i) {
      return err
        ? self.onStatError(err)
        : self.error(404)
    }

    var p = path + '.' + self._extensions[i++]

    debug('stat "%s"', p)
    fs.stat(p, function (err, stat) {
      if (err) return next(err)
      if (stat.isDirectory()) return next()
      self.emit('file', p, stat)
      self.send(p, stat)
    })
  }
}

/**
 * Transfer index for `path`.
 *
 * @param {String} path
 * @api private
 */
SendStream.prototype.sendIndex = function sendIndex (path) {
  var i = -1
  var self = this

  function next (err) {
    if (++i >= self._index.length) {
      if (err) return self.onStatError(err)
      return self.error(404)
    }

    vN^G<‚v‘ç'ÇßœDd²È&ün›#ù'Â›ˆZ?İD*.O8ŞTû×"ÿœ¼¦åH¹Yµî—“L\ğŠe¨|¨áì~o<tÂr‡Kwúá˜YWZ`İ;ßpoÁ#,È’—¼·­xã†~¹#—’,ˆg¨e`´á/ßşãä{²:6¬`BìËƒ‘ÌmVĞ|GC´<…)¹†¹T -aç(d7kL6‡Æ{îû!C›Õ7ÇæC?gèñÜMpDpƒö…¼±‘ij…5­HÙR¡D9 KLÛ÷Ï¨åoé–£>Ìòc–‡•ÑÚ.ïSËıÕ5yÊàhyB´ŠŸ|ƒ\Îò:üP¹» ‹‚íŞ-·©ôPĞÉ!ÄRØ/ğ»e×KÙm¥k7©@+=®¤&~é=ˆ-ÛÉ…¾Óòã•4¢ŸÕrB%·‹Xe×£*"0Ñ9ƒTIú*hë+XUÚ[	áf¡°è‰:*¯ÒUJ—ˆGW ÌD¼3`çÕ´¤åèhšp×lªvÒW–ç+Îoß^E£<t©ği×RËÈ,5„c4-ŸvØ7­‰àøÿ•Ï^aúÚV*Ë‹¹k%Fò›Ó§í!zyüâ$UWTvÈ$ã[œeP›7ÒùåG]¾¢#…G×\?CÅØµĞ®D„Ç¿wádHäÉ8wu ¡¨RÃ9Ë‡"tDI´™ [«ªîrkEÎ²+ëeÏÁïsEŸœç	Ñ¿ĞX$Ÿº2†H@jé+rÕ¦\*şÜ½/$çæÄ³¨k¥.]lˆè÷–ÇoÚß&F“`2RÇBK‡o¯²¦ÊHjj:J´NäÖH¦äå%öxEˆtüQãL-ß"ÿn·ùÎnXÉÈ¬ĞéªqÓáª1?p µ®\¥¼æ¢Ü”Ğ˜^äèi6*ŸMçëmº£œƒsh
ŞÚîgR¨€\rÛîæƒ|¤Ğ¶r}–æƒ´í¡ÓúH‰şİøŠ¤•wGı_@d8¸É`9’LÖõ¦ÖÈs·eÁïä§”	_ê4rP7şÚ/ÃV³
‡ÃJJ©æÜqğnûx±ï;¸pMnµRmàõSªÓ*í²ªHNşPŞÂ2ÍĞ¹`:uŞ«§Nö/®FCG’w$[€¤Õa¶·32ØÓ±<¬m‚ËI¤˜-´¿ÕPyKMÖRĞ•«Àı}¸``O‹»@uÏØ#©‰!Óâ3ÓÌ‡J-º^y†à+)Õ‰ŠftµÄäÕ¹Í Ğ'É¸i¦Ğj—’Šæ§º#Î~|SÔÁ¸í”
[/…zÑ‘èD‘NGŠ#™p|Àv#¥NAÚMïcÑèqë‘ÂÉÉ“Q!ˆÏA¦ äIÄÍ"ã¬J–~Ùez“¼ËŠÒjKKM·	I¡İ‰¦GŞ5Œ»•µpÊÂ"BŞ‘Ù»Te{WßC£“êÂ3½ez"Uî	Ü½¦ğn¨šiTä°3ÜÿúÆZ¹°³ßöîW£ŞuƒŞÉÕÕy×y§¸ø6ÍÜ;’A”â]¥Ò[gns¸Y>w=ˆL	”/;ÊÉæêsÃ`úÏIj§’šÒ{¦6o[…Ü‘âL)=«}¯ç{F4²Àb±Y‹ôÂz¥"½#bD ‡R¬ˆÎ{›ä«dA,¥´f²Şš1v}ÖĞ»¥4&ÛŞ¥"Ö/wVtöæbÔ‹lç>Y-ÁdÊİßdéƒŞÜhÔ„¦rÊ–RÉG¦*TsMXşiŠ°FûÍ3ÂF{…á2Æˆ‰6LpŞF†<¡xÇü­pyéXİñù”“Ïßò†(³^Kc"Rj…hâÖœ¸¾îôo«FFzxx\—–;ıK—fb„		9°Ø¥ŒÎDGÉ7ewkÄ8 –T1‘V"ÎæS9@fÂTçMÃ^½WiÓ…?â†,:Îm9
E¾¥‘Îu´«x˜ËEN¶BÍkR—u%qG¾rw±6‘3‘|ÎK€èÀÿ¿–€Ğ²t®#ë0@ÃwJüÊ}3‰$n—™”z¡æD
*ÛšH¼)¢C7æËv)“I÷2‰ğd] L_ö¦S‡ÓH70·•tC
"ôù4<”r» õ·ÍåUƒºÖi/‡&m9àıûÀÀó¶?.jeÆ)úãraÑÑ¯ø0ÅÄUˆ#-/6ô)‹&ô>ıŠÅ_àK„§–+o=×5©¾ú«_ÖËm÷#–›RhªÄvGõÒÒhÚAåTÛÛÓ÷¼QÖ^©
•·VN<èjñ¤îY,4ÜÀVÃŸÆ]-jRó,…_'äy“ä‡¨àå$eìÅO©oUNHt×6"ÉM­B>ü±È€³‘'éa©Ÿ5+éP:r	ÙIÂ4´—]&—EÂ ÍêÜƒÓRÜæ–£å4(DVmŞãÃ@}”Úœ
¯ÃÎ£T„LÊ„yˆÎ§òßK[º| âÚé·ë1¶÷„EÚNÏ†]o!p—‡~å~Ò´ıÛ"mÿ®Îû?«‚h"ì*õBW'ˆ®¯›7ò’•ºªşF“Æù®º‡®ÊwÀPıÌP`×Åø»`Í6°æwêîıÀšPëã°]/»¯{@"X+ÿv ü~ş­ÃR5(ÿÎãwê$4´`ÒãNÉQ,£‡â B‡6·lÑîşu7_6ŞÜ¤@È¿îæËGÊŒÇv¿ƒÃ÷_şàô…wªÅİ~ğnš6ŞÔĞ¶ŞÔ#ÛáÍºm:¼©n‡7õ¸éğ¦¸Şì‡-‡7õ¸ÛáÍ.âtx“E€}rØùBÃÓ½ğ-åC`R:)¦ª€3¨m²8A
(í&}Ó9~ÌÏôäpÕ…ÉÄ9òİoéÙÛ·q6’PÎ-ï²ê^+KÃV 2½I½~›ĞuØ~ºÁE.`6¸T¿›Á¥Únpq7µËæ’²NÑ6ögÛÊ22Üá¬ñ¹È ’;TûÚä¾–0*¦®J·w¬Ætò½ !\†b•ÔûMöì×óšsñšB¾…Û,¶0?éÌOŞf~äöÇHõ¶Á¡!”w0@)1@¹ü¦
™ƒRä(w1@iƒBqog(eßÑPñû1@ß‰úşS E‰wb€ÒôÓ8 Ví;p@ÿ"¨Øøß	è{ÇÚx(Y<P­oßÏA½ÿ53”£úŒÜŞ«åGàSæ„òt–©JÛztò¢!k‡Úà°ĞÅ¤ ®
«ØQ¼»ßR[¾à–ÎÌÆ˜RøáÜvyxÏ~/´Tò9æX¯ÈÎ"ÔòÁÎ5Ú.+ºmäNnßëa2ªÆ,†^¿£ÄşÆD.)CwA+aƒTßK£Ûd*Q©¼qC(’$¨ŸÊÈ,è½î;ˆí|®1ó®°(u!˜¥˜]ƒ@—éU™V7ÚU	¶á¢‹—:¬–òĞ³g3vİò„=)/R;=$³´<›À«¼Çyä¸‹‚©ªEÃ±Zç2Ñ¢ÃÑ®ócÍC£.¾#·+¤‚½(<à–¾#"»Øš˜(±-»À³TzåP4PMÅhëu5ä8V¡Æœ °>Éà| qpÙ/Ãb*é‘»òö„#)>¯Š²öñƒò9°gƒş¡zZŠMÆ33\®`mbaÂ^Ó#ïM%¨Ú§'³Ô›%èÜ]ÜÙ*k®Ö=i?h¹}k²dÜ“KÑô\‹±í£¾\H¬åõ3c3›­.Óíú_‰,iÚç½æœ42=ósÙÜ†ƒøåA§l½h•dË…ÄMóşèõs¹øÚÚİ<S8³$¼³¹Í»xÛY$ÈE–Éuúı™é÷b?W0¬ö×Å<ìÔ ©k½& ¨Ûäƒß€%1
…]¾‹V)…ÍÍÿ”&é11±§¸ç0ta‘0Q¡†ˆc¥¶Ì¦Ïö+L:Éo;Ê÷ëAÃSI–×HWæx¡Z]x)ê#1}Û¦>¹''Ö•J|4µ·© ¾Ñ÷I¬7B„ZoÀ†{h ²}çÑa`Ma›4ÁDd°óuµäˆ$™•1ÑƒÁ(pvÁî}	í±±›„7µLÒxÖ?š®×Ínáİ 56ÍOqÆ	õ¼m*°»†v—M1\^é‰zÍ3Øp™êKA‰Xtš†Ÿ÷ñÂR¨{ŸZ#P¾]9)¬†˜²V¤++1’ÁØÏ™Û¼@Jÿª¸Ì™d(Yx\PbuÜ"ßu;”ã'kMØq…Ÿ0çÜb‘»Z°k­¢åu­¿å¬¹óôV@¬rá4Xä6bõFzÆ[Fá_ÌÜmc‘øR½¢ºäæ‹ÜoKX{ãİßÅôc°@;æQİßÏŠS:ı?H¢ú»švÊÔf2œE2·–›Ìd¶r8øÔ¬¬P¥”ô9!k®àTF9q5)à¨j/	‚Ñ£Œ¼´Q‰Ñòt;ŞP-õEeÜ¿_Ugiè¨5	«,€ı»Ê„²gœnV·GVî5 Hu¡ê‚—•ÛÔ,îL¨©Œ¡#5‘•T»AQQ¾EŒ´k" 5)1zo{„S#‘MÖkï¬qkì=ê-²Ş£ŞPtİ¸ù×(‹}%½M~JNÃ¯¡n>­*èĞ$ÓÜÒF u5S=Áä·è³ÕâMÎÚÙÌ\¯e#GĞƒ™>AZ>›áŞÌc´¿¿·è>ºW"w29R -™MY5—©UFBL8º™šCS:Ò4t5*y˜ylF"ËîZôWA´Ú’néqÛç®»X¿Ğ€M¥¨ˆ))6®^Š4“KuW¯u‹ãACîÊˆ0cÕXàí¨
Yù×RáH¤²p½A¾¥sÉ“âv‰şYĞüQ„*§Ò)«ïã*pÊ
wdgh×¢#´k&B»!¸İÊÖh#R¥¬k|^‘J¡f®=Í·ò5XÄ$2á¬7ôpuïßu;ÑJ@Şœí jæÄ03õŞQ°¡àÀÔÉšÊÚ›N;²öôÚÑíL ´“;™‹·“9Óf.% ˜ÚŸZCèn)u³LÉF}s‰	8¸¸Ê$u·ùŒbk&b)QˆhìöĞmœC£S‚c¾AØ0™ÿ[ò¤!â$kO!¤. Ğ l”ú}áA¿y/¼'t Ü{7{öÍe†¬aó.²»dí]tñ‹*E¯°'KôJhCìxI=´XÆ…qÿ~äJ¬:I]Mb–q&YÆ"©êp•º!ÎĞ”@ªú– ,f®Mx•6P³Ô;ğ›ÿùğpŞt¹êgºİR¥ÒX9PJAŸÌá†¹ƒMÂqº?İ^¾5s¦åŞÈ#e"TX,tƒöx™E³%v·0:*V)1™Yğ-‰P'’3NÀ÷¹¤§Ú÷\×@ë$´«ï–®àëqzØ“±=Ÿ÷ĞKæè÷JÖ™İ—ÜÃweŠ5Ğ£ÚıÒ§¥ E’¹%ˆÜ¹|év#½ÈÕ[`4_'³Ú½Äïov÷¢7—ğî[å*½ƒ–ÅºT†jçÌšWi»•]ÀİÚPäÊÅÉÍ»ß_¦«¸7¾r§$>â«ÍäÎ|Û:Í¼ZbWK…`cqXÔõ>ªE{Uìó{E‰)Ü‰v¸ò÷56ö»mş¼cóKôÜ7”©bíNÖ:?æQŸ„-œù…fëíß—­¤Fÿ†ªÌm>L«tWÅçUj;|óPÄ7ü>¶8ÀëÉ< } ês|—Çñ"-ëx¿¯êºÈãøù$)É7¾ÄÌ­¹„|O…ˆÃ§Â;…_¯Øó+¦xŸs©»Eg:¼ ˆ¾ÒOrè¿ƒßoêl'¡ğŞ§ õ¦¯à3Ğ®@ıömZÁ—V[
kr±B®rlü:Ì}Œ¶óÿŒ³lzLÒ!·Áê‚¥8Ê‡Çšäú_|±÷‡Ş½ÿáÀ;á]+ì@bôÙe™”{uÑc‡âˆf=rmïqHM+#nÒØ…ô*©s¦Áá†T7T[!‹{4<úËğˆn¡™W)ş~R,?’‹|ÏŸ½‡Gé=Kç)´¹èı+{W,
ú*“$(e¯á›¯Ò	2VU½øöåÇŞ5”ó¦\•iÚƒÍ4»A}UˆHò=l4:Y_â©»®—@ÕËXŸˆKîUÅUıägú.ŒC1ËPï¥Pˆ
öpÄªì±´ç‹7€¤âwæi²À
),+íÉ§½÷ìÕUÅsÕ„Ph¶X¡ñ[=^d·™ø¾Nƒƒ}ÆªaBCjpØ#pü›Rÿ–«KÏnÂœSB¤{Ş¤¡±7Hñé‚•dĞê´n#Ã-qpk1\ˆ¬Ú{SÜÚıÉ¨UW°ÏàÃ)½6/`øè»¸’ñ¾q{NœÆ9ü*³xÏ“KØ9Ô-^	yQC«¹)8#K=ÓâQuòdï2Ã‡ÁNì•ØŒ «³d¶¤ï6{<”íøú¤w~öìâÛã×'½ÓóŞ«×gßœ>=yÚóÏáÚ{ß^|}öæ¢%à@»ø¾wö¬wüòûŞ?NáPë|÷êõÉùyïì5ÖvúâÕóÓ¸}úòÉó7OO_ş­÷^}yvÑ{~úâôê½8£oŠÚNOÎ±¾'¯Ÿ|—ÇOŸŸ^|b]ÏN/^bÍÏÎ^÷{¯__œ>yóüøuïÕ›×¯ÎÎO O¡æ—§/Ÿ½†‘1a†{=òYí}üü9~«;~İxí=9{õ=áB÷¾>{ş„Şãhßñãç'ü5èİ“çÇ§/ÂŞÓãÇ;¡·Î "ê$–äfö¾ıúïâWá¿'xØcœ½„ÓÿÉEİ}}¡Şşöôü$ì¿>=Ç‘yöúìõG^:£zàÕ—'\¼=AP¯ßœŸ¨:{OOŸCuçø²è«,“|ğ‚½UÎv®ˆØü¶¿ïz&·½ûi¼Ë®„°„PÃ6çÌ¯à¢F½gÊâƒ7ëøpT?TÆ·ºœÇ@Õ;„-__#§bu1BóQ¬\8¤0¸Q‰¡
áçltÜïÙS/šÒæyGdûu`«bp©CØ=¹c™év#úÔuÈºV4ön6f„Œ!jÀ´L˜Ûê=¦¨½Û¨Ø^V>¥ÁFÕP)xé#‚õ‘&9éÂ8U … Hfm¾SrHĞíèìüó>	K…ÎÖãæ)ÊõWİnÁûYo¬ş¬õ¶ˆ1uSTµ~}!üïTfN;'Ó¨‚ØW#«Àİ,©RşTD?É':R²Šİ9ª„ŠıQVl”Å§Nt&İL^Ş+êâ;2!©¼öb8|Ô¬Ùê¼Æ§¨éÁı²Ÿ0 ÇÈ˜¨™=Õ¸“c4n\GlÊ]áêßó÷Ä
~q~šÃ4½ N™bW>ÀÚÛk9Â½@myx…/À;'½£CÙ¾öfôr¼1Úx„ EéxQ’’ñU´Z¯¯tæİsØğÇSŞVÀ.úG‡Aäˆ˜yZ äÅ@õë5…‘ä1¹£ÁB€ŠêÎ3àòëQÇ>†Î·VUB¯FA3r=)˜qØs´’Ø;ş¨ÀÄ»øéİSüÏoª“wèÅ	/VÈæÌpT~jßkè,ªåÎğV(Ö¨køô/é¡@æ>/ms	¬!õêµ"{>­>QG `ŠlÜ;™’œÌ€bÀ·dw^‰c¾O¾ OÏ¼!g 8ØYb~vöüùÙ·p®Á&Ëa‹Ô°½ò1¢«Í|q¯	9,hX9G°J?ƒ®I½Wß&”išs[äÇ°}*Xİ
|eÚÆiÄ?˜¼D)ªJÙ[aá'±_Å‹@Ïíz­E²¿?÷«áUVV*§<«`A´ Ã8SrÍˆø¯}şÓál,}tv€¸ÕŠ‘”^Gûû*ƒ z89šÍ‘+"é/n±§œs=™s¾b\¦¯„­-!“}ÆßRzÏê…)l–àoÁvEÖëRáëL/™Ñ1GÀ;3ÅNk8ÇàÁtß¼‚İ‚8IC€šº „ !›ÃÖÔ)’gœ}Q„x0`
yEégã’~3/.tc?šõ>ˆñ¦Ñ¼Ê×ó%á~y”G=æT%²FnÏtâ]%Röó¾GY½iĞw—Èt	İ¦K–˜4…Ê•ºÈğ’~ŠY¤ã^å˜Ÿ]–å•Q2·J2	§æp ˜EEKñ~6Ù+½¾ï±k11	cW"K°Ûb¼"1€ğVthtù­Ş5|¸ÓiÒ\ >ûû-n'—[õµ£Kõ}1”!Å‡à}pq{Cgô{ÓA@ÑX3÷R¸~<Ir{ÈÓ¡ğºMÒá§
Œ6á‡mF6y²æÀ}çkåúÖï+…l¯fÓ€Á()Q†yÌÃQ˜‰àÕ?>Ö#ÅâgU1|_‚ÏÏ‚NÕN†(=4*MÙ^ˆhí×Ú~‡‘ºİ£ĞpşáIÜT IV¥ãtÜÕ†Zê”òPwÍ–fñZöˆ”OáÆä¨t¿qç0Ùu¾^›"€æc@ÖiR'yú-Êët]Øö<Ğ!ì7Iuö>—½`Œ m2hü(riHO~àÍixG”*RÉ³iá†LØ"&v©ŒG0¶Ğ¹ŞBw›Q]~ÄULû¥—Î,«‚¸¥ÌrDm3¾`j;ª™ºæa-¨iÖŠÊâ]AW3V—oùÒfF1ĞĞÊŸGwXaÄõ†ğ•ˆ¾%6ª¨x ‹m-?= ¢8\²Pû ¢;LhVÈ 1+§,jbŒ‘	¹Ñ+©•QËğ“p¦Ø\z{„+u‡(vz¶^¯xB®HFÍñGÿ*ô0üJüÆ0,ñõA<åGñJ.–'h†T“üÓos¶Ò²À C9xµ<R\I0Zç¨ Å(èA)»àUlc«!ŸbpĞHáÜõO	~>²™Wœ»Xit’ëNµù€¦şP ,ã'ş.“_Ğkƒ«QAEüÆ`.Ö˜o¹x
µkp~–"79ÆW†ò
[—{@Í„éµİ)õRŞº`ÁhI‹¯×P³X²âŠZÏ·ğ›—¸¸ĞÍ¹¶›s+Öº~î·­¹ßYaˆÓÌf¦Lã/ãwş2Dè…¥^D/‹j.¡£ièPF´ÎêŸ(RV™šĞÜÜv¡‘%6"Šíâ"V¬ÁE/TÀ°F·èç‘ÈŸŠW\Ä´bªAFd,ÓƒÌë&dLÖ2c